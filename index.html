<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container-xxl">
    <h1>Foo</h1>
    <canvas id="canvas-preview" style="border:1px solid black;"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
	( () => {
		'use strict';

		const previewElement = document.getElementById( 'canvas-preview' );
		const context = previewElement.getContext( '2d' );

		window.addEventListener( 'paste', ( event ) => {
			const uploadedFile = event.clipboardData.items[ 0 ].getAsFile();

			if ( !isImage( uploadedFile ) ) {
				return;
			}

			const reader = new FileReader();
			const image = new Image();

			reader.addEventListener( 'load', function () {
				image.src = reader.result;
			} );

			image.addEventListener( 'load', async function () {
				context.clearRect( 0, 0, previewElement.width, previewElement.height );
				context.drawImage( image, 0, 0, image.width, image.height, 0, 0, image.width / 4, image.height / 4 );

				const clipboardItem = new ClipboardItem( {
					'image/png': new Promise( resolve => previewElement.toBlob( resolve ) )
				} );

				await navigator.clipboard.write( [ clipboardItem ] );
			} );

			reader.readAsDataURL( uploadedFile )
		} );

		function isImage( file ) {
			if ( !file ) {
				return false;
			}

			return file.type === 'image/png' || file.type === 'image/jpeg';
		}
	} )();
</script>
</body>
</html>
